# checkpoint_04012026_1923

## What I reviewed

- `AGENTS.md`: persona/process/quality guardrails (address user as Othmane; be direct; run checks when making code changes; create a checkpoint note each task).
- `api_docs/quickstart/*`: high-level system map + minimal end-to-end flow (Gamma discovery → CLOB pricing/book → auth → order placement), plus rate limits and base endpoints.
- `api_docs/developers/*`: deeper dives on CLOB auth + orders + websocket, builders (attribution + relayer), market makers (setup/trading/feeds/inventory), RTDS, CTF operations, neg-risk, proxy wallets, subgraph, UMA resolution.
- `api_docs/api-reference/*`: OpenAPI-backed route specs for Gamma, Data API, and a subset of CLOB endpoints.

## Polymarket API mental model (concise)

- **Gamma API** (`https://gamma-api.polymarket.com`): public market discovery + metadata (events/markets/tags/sports/search/comments/series).
  - Data model: **Event → one-or-many Markets**; market contains `clobTokenIds` and outcome metadata (`outcomes`, `outcomePrices` arrays align by index).
  - Typical discovery strategy for “all active” is `/events?active=true&closed=false&limit=...&offset=...` then traverse embedded markets.

- **CLOB API** (`https://clob.polymarket.com`): public market data + authenticated trading.
  - Public: `/price`, `/book`, `/midpoint`, etc.
  - Auth: two layers:
    - **L1**: EIP-712 signed “attestation” headers from a private key (used to create/derive L2 creds).
    - **L2**: HMAC-signed request headers using `{apiKey, secret, passphrase}` (used for order management / posting / cancellations, etc).
  - Trades settle on-chain; orders are EIP-712 signed; “market orders” are just marketable limit orders.

- **CLOB WebSocket** (`wss://ws-subscriptions-clob.polymarket.com/ws/`): near-real-time pushes.
  - `market` channel: public orderbook + price-change-style events (and some optional “custom_feature_enabled” messages like `market_resolved`).
  - `user` channel: authenticated; order/trade lifecycle events filtered by api key.

- **Data API** (`https://data-api.polymarket.com`): public portfolio/history aggregates (positions, trades, activity, leaderboards, etc).
  - Example: `/positions?user=0x...` with filters like `market`, `eventId`, `redeemable`, `mergeable`, paging, sorting.

- **RTDS** (`wss://ws-live-data.polymarket.com`): separate websocket for low-latency streams (crypto prices, comments).
  - Supports “dynamic subscriptions”; recommends client-side ping ~5s.
  - Auth varies by topic (CLOB creds vs Gamma-style user address).

## Key implementation constraints & gotchas I’m tracking

- **Wallet types matter** for signing + funder address:
  - `signatureType`: `0` EOA, `1` Polymarket custom proxy (Magic Link), `2` Gnosis Safe proxy (common for Polymarket.com users).
  - “Funder” is where balances/allowances are checked and what holds USDCe + outcome tokens.
- **Allowance/balance reservation rails**: open orders reserve balance per market; you can get rejected if total outstanding commitments exceed available funds.
- **Neg-risk**: multi-outcome “winner-take-all” events relate markets via convertability; `negRiskAugmented` introduces placeholder outcomes you should not trade.
- **CTF operations**: split/merge/redeem are contract-level primitives; relayer can make these gasless for builders.
- **Rate limits are high but not infinite**; Cloudflare throttles (queues/delays) rather than hard-failing immediately.

## Doc quality notes / potential missing pieces

- Some pages in this snapshot render with `# null` titles (e.g. Gamma overview, proxy-wallet overview). Content is still usable, but titles are clearly broken.
- The market websocket `price_change` page references a migration guide path that is not present in `api_docs/` in this repo snapshot.
- I spotted at least one likely typo in a Python snippet in `api_docs/developers/CLOB/authentication.md` (`chaind_id` vs `chain_id`).

